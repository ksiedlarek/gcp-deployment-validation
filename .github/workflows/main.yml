name: Manually triggered workflow
on:
  workflow_dispatch:
    inputs:
      name:
        description: 'Person to greet'
        required: true
        default: 'Mona the Octocat'
      home:
        description: 'location'
        required: false
        default: 'The Octoverse'
      app_link:
        description: 'App link to query'
        required: true
env:
  STATUS_CODE: 0
  CURL_TEST: false

jobs:
  say_hello:
    runs-on: ubuntu-latest
    steps:
    - run: |
        echo "Hello ${{ github.event.inputs.name }}!"
        echo "- in ${{ github.event.inputs.home }}!"
    - name: Run curl on app link
      run: |
        RESULT=$(curl -s -o /dev/null -w "%{http_code}" ${{ github.event.inputs.app_link }})
        echo "STATUS_CODE=$RESULT" >> $GITHUB_ENV
    - name: Verify status code
      if: ${{ env.STATUS_CODE == 200 }}
      run: |
        echo "CURL_TEST=true" >> $GITHUB_ENV
    - name: Display values
      run: |
        echo "Curl test passed: $CURL_TEST"
        echo "Status code: $STATUS_CODE"